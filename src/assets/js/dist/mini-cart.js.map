{"version":3,"file":"mini-cart.js","mappings":"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","sources":["webpack://simple-secure-stripe/./src/assets/js/frontend/mini-cart.js"],"sourcesContent":["(function ($, sswps) {\n\n\t/**\n\t *\n\t * @param container\n\t * @constructor\n\t */\n\tfunction MiniCart(params) {\n\t\tthis.message_container = '.widget_shopping_cart_content';\n\t\tsswps.BaseGateway.call(this, params, container);\n\t}\n\n\tMiniCart.prototype.on_token_received = function () {\n\t\tthis.block();\n\t\tthis.block_cart();\n\t\tsswps.BaseGateway.prototype.on_token_received.apply(this, arguments);\n\t}\n\n\tMiniCart.prototype.block_cart = function () {\n\t\t$(this.container).find('.sswps-minicart-overlay').addClass('active');\n\t}\n\n\tMiniCart.prototype.unblock_cart = function () {\n\t\t$(this.container).find('.sswps-minicart-overlay').removeClass('active');\n\t}\n\n\tMiniCart.prototype.get_gateway_data = function () {\n\t\tvar key = \".woocommerce_\" + this.gateway_id + \"_gateway_data\";\n\t\tvar data = $('.woocommerce-mini-cart__buttons').find(key).data('gateway');\n\t\tif (!data) {\n\t\t\tdata = $(key).data('gateway');\n\t\t}\n\t\treturn !!data ? data : {};\n\t}\n\n\t/*------------------------- GPay -------------------------*/\n\tfunction GPay(params) {\n\t\tMiniCart.apply(this, arguments);\n\t}\n\n\tGPay.prototype = Object.assign({}, sswps.BaseGateway.prototype, MiniCart.prototype, sswps.GooglePay.prototype);\n\n\tGPay.prototype.initialize = function () {\n\t\tthis.createPaymentsClient();\n\t\tthis.isReadyToPay().then(function () {\n\t\t\tthis.append_button();\n\t\t}.bind(this));\n\t}\n\n\t/**\n\t * @return {[type]}\n\t */\n\tGPay.prototype.create_button = function () {\n\t\tsswps.GooglePay.prototype.create_button.apply(this, arguments);\n\t\tthis.append_button();\n\t}\n\n\tGPay.prototype.append_button = function () {\n\t\t$(this.container).find('.sswps-gpay-mini-cart').empty();\n\t\t$(this.container).find('.sswps-gpay-mini-cart').append(this.$button).show();\n\t}\n\n\t/*------------------------- ApplePay -------------------------*/\n\tfunction ApplePay(params) {\n\t\tMiniCart.apply(this, arguments);\n\t}\n\n\tApplePay.prototype = Object.assign({}, sswps.BaseGateway.prototype, MiniCart.prototype, sswps.ApplePay.prototype);\n\n\n\tApplePay.prototype.initialize = function () {\n\t\tsswps.ApplePay.prototype.initialize.apply(this, arguments);\n\t}\n\n\tApplePay.prototype.append_button = function () {\n\t\t$(this.container).find('.sswps-applepay-mini-cart').empty();\n\t\t$(this.container).find('.sswps-applepay-mini-cart').append(this.$button).show();\n\t}\n\n\t/*------------------------- PaymentRequest -------------------------*/\n\tfunction PaymentRequest(params) {\n\t\tMiniCart.apply(this, arguments);\n\t}\n\n\tPaymentRequest.prototype = Object.assign({}, sswps.BaseGateway.prototype, MiniCart.prototype, sswps.PaymentRequest.prototype);\n\n\tPaymentRequest.prototype.initialize = function () {\n\t\tsswps.PaymentRequest.prototype.initialize.apply(this, arguments);\n\t}\n\n\tPaymentRequest.prototype.create_button = function () {\n\t\tthis.append_button();\n\t}\n\n\tPaymentRequest.prototype.append_button = function () {\n\t\t$(this.container).find('.sswps-payment-request-mini-cart').empty().show();\n\t\tthis.paymentRequestButton.mount($(this.container).find('.sswps-payment-request-mini-cart').first()[0]);\n\t}\n\n\tfunction Afterpay(params) {\n\t\tMiniCart.apply(this, arguments);\n\t}\n\n\tAfterpay.prototype = Object.assign({}, sswps.BaseGateway.prototype, MiniCart.prototype, sswps.Afterpay.prototype);\n\n\tAfterpay.prototype.is_currency_supported = function () {\n\t\treturn this.params.currencies.indexOf(this.get_currency()) > -1;\n\t}\n\n\tAfterpay.prototype.initialize = function () {\n\t\tif ($(this.container).length && this.is_currency_supported()) {\n\t\t\tthis.create_element();\n\t\t\tthis.mount_message();\n\t\t}\n\t}\n\n\tAfterpay.prototype.create_element = function () {\n\t\treturn this.elements.create('afterpayClearpayMessage', $.extend({}, this.params.msg_options, {\n\t\t\tamount: this.get_total_price_cents(),\n\t\t\tcurrency: this.get_currency(),\n\t\t\tisEligible: this.is_eligible(parseFloat(this.get_total_price()))\n\t\t}));\n\t}\n\n\tAfterpay.prototype.mount_message = function () {\n\t\tvar $el = $('.sswps-afterpay-minicart-msg');\n\t\tif (!$el.length) {\n\t\t\t$('.woocommerce-mini-cart__total').after('<p class=\"sswps-afterpay-minicart-msg buttons\"></p>');\n\t\t}\n\t\tvar elements = document.querySelectorAll('.sswps-afterpay-minicart-msg');\n\t\tif (elements) {\n\t\t\telements.forEach(function (el) {\n\t\t\t\tthis.create_element().mount(el);\n\t\t\t\tthis.add_eligibility(el, parseFloat(this.get_total_price()));\n\t\t\t}.bind(this));\n\t\t}\n\t}\n\n\t/*-------------------------------------------------------------------------*/\n\n\tvar gateways = [], container = null;\n\n\tif (typeof sswps_googlepay_mini_cart_params !== 'undefined') {\n\t\tgateways.push([GPay, sswps_googlepay_mini_cart_params]);\n\t}\n\tif (typeof sswps_applepay_mini_cart_params !== 'undefined') {\n\t\tgateways.push([ApplePay, sswps_applepay_mini_cart_params]);\n\t}\n\tif (typeof sswps_payment_request_mini_cart_params !== 'undefined') {\n\t\tgateways.push([PaymentRequest, sswps_payment_request_mini_cart_params]);\n\t}\n\tif (typeof sswps_afterpay_mini_cart_params !== 'undefined') {\n\t\tgateways.push([Afterpay, sswps_afterpay_mini_cart_params]);\n\t}\n\n\tfunction load_mini_cart() {\n\t\tvar $elements = $('.woocommerce-mini-cart__buttons');\n\t\tif (!$elements.length) {\n\t\t\t$elements = $('a[class^=\"wc-stripe-\"]');\n\t\t}\n\t\t$elements.each(function (idx, el) {\n\t\t\tvar $parent = $(el).parent();\n\t\t\tif ($parent.length) {\n\t\t\t\tvar class_name = 'wc-stripe-mini-cart-idx-' + idx;\n\t\t\t\t$parent.addClass(class_name);\n\t\t\t\tif (!$parent.find('.wc-stripe-minicart-overlay').length) {\n\t\t\t\t\t$parent.prepend('<div class=\"wc-stripe-minicart-overlay\"></div>');\n\t\t\t\t}\n\n\t\t\t\tcontainer = '.' + class_name;\n\t\t\t\tgateways.forEach(function (gateway) {\n\t\t\t\t\tnew gateway[0](gateway[1]);\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\t}\n\n\t$(document.body).on('wc_fragments_refreshed wc_fragments_loaded', function () {\n\t\tsetTimeout(load_mini_cart, 250);\n\t});\n\n\tsetTimeout(load_mini_cart, 500);\n\n}(jQuery, window.sswps));"],"names":["$","sswps","MiniCart","params","this","message_container","BaseGateway","call","container","GPay","apply","arguments","ApplePay","PaymentRequest","Afterpay","prototype","on_token_received","block","block_cart","find","addClass","unblock_cart","removeClass","get_gateway_data","key","gateway_id","data","Object","assign","GooglePay","initialize","createPaymentsClient","isReadyToPay","then","append_button","bind","create_button","empty","append","$button","show","paymentRequestButton","mount","first","is_currency_supported","currencies","indexOf","get_currency","length","create_element","mount_message","elements","create","extend","msg_options","amount","get_total_price_cents","currency","isEligible","is_eligible","parseFloat","get_total_price","after","document","querySelectorAll","forEach","el","add_eligibility","gateways","load_mini_cart","$elements","each","idx","$parent","parent","class_name","prepend","gateway","sswps_googlepay_mini_cart_params","push","sswps_applepay_mini_cart_params","sswps_payment_request_mini_cart_params","sswps_afterpay_mini_cart_params","body","on","setTimeout","jQuery","window"],"sourceRoot":""}