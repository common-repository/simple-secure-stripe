{"version":3,"file":"form-handler.js","mappings":"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","sources":["webpack://simple-secure-stripe/./src/assets/js/frontend/form-handler.js"],"sourcesContent":["jQuery(function ($) {\n\n    /**\n     * @constructor\n     */\n    function Handler() {\n        this.init();\n    }\n\n    /**\n     * Initialize functionality.\n     * @return {[type]}\n     */\n    Handler.prototype.init = function () {\n\n        // event emitted from WC checkout.js\n        $(document.body).on('payment_method_selected', this.payment_method_selected.bind(this));\n        $(document.body).on('change', '[name=\"payment_method\"]', this.payment_method_selected.bind(this));\n        $(document.body).on('updated_checkout', this.updated_checkout.bind(this));\n        $(document.body).on('change', '.sswps-payment-type', this.payment_type_change.bind(this));\n        $(document.body).on('updated_wc_div, updated_cart_totals', this.cart_html.bind(this));\n\n        this.saved_payment_methods();\n\n        if ('MutationObserver' in window && null !== document.querySelector('form.checkout')) {\n            var observer = new MutationObserver(this.observer_callback.bind(this));\n            observer.observe(document.querySelector('form.checkout'), {\n                attributes: false,\n                childList: true,\n                subtree: true\n            });\n        }\n\n        if ($(document.body).is('.woocommerce-cart')) {\n            $(window).on('resize', this.cart_html);\n            this.cart_html();\n        }\n    }\n\n    Handler.prototype.observer_callback = function (records, observer) {\n        try {\n            if (records.length > 0) {\n                for (var i = 0; i < records.length; i++) {\n                    if (records[i].addedNodes && records[i].addedNodes.length > 0) {\n                        var nodes = records[i].addedNodes;\n                        for (var n = 0; n < nodes.length; n++) {\n                            if (nodes[n].nodeName === 'UL' && nodes[n].classList && nodes[n].classList.value.indexOf('payment_methods')) {\n                                // destroy the select2 elements so they can be re-added since previous events are orphaned\n                                $('select.sswps-saved-methods').removeClass('enhanced');\n                                $('select.sswps-saved-methods + .select2').remove();\n                                this.saved_payment_methods();\n                            }\n                        }\n                    }\n                }\n            }\n        } catch (err) {\n            //fail gracefully\n        }\n    }\n\n    /**\n     * @return {[type]}\n     */\n    Handler.prototype.payment_method_selected = function () {\n        var gateway = this.get_payment_method();\n        $(document.body).triggerHandler('sswps_payment_method_selected', gateway);\n    }\n\n    /**\n     * @return {[type]}\n     */\n    Handler.prototype.updated_checkout = function () {\n        this.saved_payment_methods();\n\n        if ($(document.body).hasClass('woocommerce-checkout')) {\n            if ($('.payment_methods').width() < 475) {\n                $('.payment_methods').addClass('stripe-small');\n            }\n        }\n    }\n\n    /**\n     * @return {[type]}\n     */\n    Handler.prototype.payment_type_change = function () {\n        var gateway = this.get_payment_method();\n        var $input = $('[name=\"' + gateway + '_payment_type_key\"]:checked');\n        if ($input.length === 0 || $input.val() === \"new\") {\n            $('.' + gateway + '-saved-methods-container').slideUp(400, function () {\n                $('.' + gateway + '-new-method-container').slideDown(400);\n            });\n            $(document.body).triggerHandler('sswps_new_method_' + gateway);\n        } else {\n            $('.' + gateway + '-new-method-container').slideUp(400, function () {\n                $('.' + gateway + '-saved-methods-container').slideDown(400);\n            });\n            $(document.body).triggerHandler('sswps_saved_method_' + gateway);\n        }\n    }\n\n    /**\n     * @return {[type]}\n     */\n    Handler.prototype.saved_payment_methods = function () {\n        if ($().selectWoo) {\n            if ($('select.sswps-saved-methods').length && !$('select.sswps-saved-methods').hasClass('enhanced')) {\n                $('select.sswps-saved-methods').selectWoo({\n                    width: \"100%\",\n                    templateResult: this.output_template,\n                    templateSelection: this.output_template,\n                    language: {\n                        noResults: function () {\n                            return sswps_form_handler_params.no_results;\n                        }.bind(this)\n                    }\n                }).addClass('enhanced').trigger('change');\n            }\n        }\n    }\n\n    /**\n     * @return {[type]}\n     */\n    Handler.prototype.get_payment_method = function () {\n        return $('[name=\"payment_method\"]:checked').val();\n    }\n\n    /**\n     * @param  {[type]}\n     * @return {[type]}\n     */\n    Handler.prototype.get_payment_type = function (gateway) {\n        return $('[name=\"' + gateway + '\"]:checked').val();\n    }\n\n    /**\n     * @param  {[type]}\n     * @param  {[type]}\n     * @return {[type]}\n     */\n    Handler.prototype.output_template = function (data, container) {\n        var classes = $(data.element).attr('class');\n        $.each($(data.element).parent().find('option'), function () {\n            $(container).removeClass($(this).attr('class'));\n        })\n        $(container).addClass('sswps-select2-container ' + classes);\n        $(document.body).triggerHandler('sswps_payment_method_template', [data, container]);\n        return data.text;\n    }\n\n    Handler.prototype.cart_html = function () {\n        var $button = $('.checkout-button'),\n            width = $button.outerWidth();\n        if (width && $('.sswps_cart_payment_methods').length) {\n            $('.sswps_cart_payment_methods ').width(width);\n        }\n        if ($button.css('float') !== 'none') {\n            $('.sswps_cart_payment_methods ').css('float', $button.css('float'));\n        }\n    }\n\n    new Handler();\n\n})"],"names":["jQuery","$","Handler","this","init","prototype","document","body","on","payment_method_selected","bind","updated_checkout","payment_type_change","cart_html","saved_payment_methods","window","querySelector","MutationObserver","observer_callback","observe","attributes","childList","subtree","is","records","observer","length","i","addedNodes","nodes","n","nodeName","classList","value","indexOf","removeClass","remove","err","gateway","get_payment_method","triggerHandler","hasClass","width","addClass","$input","val","slideUp","slideDown","selectWoo","templateResult","output_template","templateSelection","language","noResults","sswps_form_handler_params","no_results","trigger","get_payment_type","data","container","classes","element","attr","each","parent","find","text","$button","outerWidth","css"],"sourceRoot":""}