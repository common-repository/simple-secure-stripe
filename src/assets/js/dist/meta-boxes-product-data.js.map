{"version":3,"file":"meta-boxes-product-data.js","mappings":"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","sources":["webpack://simple-secure-stripe/./src/assets/js/admin/meta-boxes-product-data.js"],"sourcesContent":["/**\n * Make sure we have all of the required sswps top level items.\n *\n * @since 1.0.0\n *\n * @type {Object}\n */\nwindow.sswps = window.sswps || {};\nwindow.sswps.product = window.sswps.product || {};\nwindow.sswps.product.metaboxes = window.sswps.product.metaboxes || {};\n\n/**\n * Initialize the sswps.product.metaboxes object in a strict sandbox.\n *\n * @since 1.0.0\n *\n * @param {Object} window The global window object.\n * @param {Object} $ The jQuery object.\n * @param {Object} obj sswps.product.metaboxes\n *\n * @return {void}\n */\n(function (window, $, obj) {\n\t'use strict';\n\tlet $window = $(window);\n\tlet $document = $(document);\n\n\t/**\n\t * Selectors used for configuration and setup.\n\t *\n\t * @since 1.0.0\n\t *\n\t * @type {Object}\n\t */\n\tobj.selectors = {\n\t\tgatewaysTable: 'table.wc_gateways',\n\t\tenabledGateway: 'table.wc_gateways .sswps-product-gateway-enabled',\n\t\tsaveProductData: '.sswps-save-product-data',\n\t\tsettingsSelect: '#stripe_product_data select',\n\t\tupdateProductField: '#sswps_update_product'\n\t};\n\n\tobj.params = {\n\t\tloadingClass: 'woocommerce-input-toggle--loading',\n\t\tenabledClass: 'woocommerce-input-toggle--enabled',\n\t\tdisabledClass: 'woocommerce-input-toggle--disabled'\n\t};\n\n\t/**\n\t * Bind events for the product data metabox.\n\t *\n\t * @since 1.0.0\n\t *\n\t * @return {void}\n\t */\n\tobj.bindEvents = function () {\n\t\t$(obj.selectors.gatewaysTable).find('.wc-move-down, .wc-move-up').on('click', obj.move_gateway);\n\t\t$document.on('click', obj.selectors.enabledGateway, obj.enable_gateway);\n\t\t$document.on('click', obj.selectors.saveProductData, obj.save);\n\t\t$document.on('change', obj.selectors.settingsSelect, obj.setting_changed);\n\t};\n\n\t/**\n\t * Initializes sorting on the metabox table.\n\t *\n\t * @since 1.0.0\n\t *\n\t * @return {void}\n\t */\n\tobj.initSorting = function () {\n\t\t$(obj.selectors.gatewaysTable).sortable({\n\t\t\titems: 'tr',\n\t\t\taxis: 'y',\n\t\t\tcursor: 'move',\n\t\t\tscrollSensitivity: 40,\n\t\t\tforcePlaceholderSize: true,\n\t\t\thelper: 'clone',\n\t\t\topacity: 0.65,\n\t\t\tplaceholder: 'wc-metabox-sortable-placeholder',\n\t\t\tstart: function (event, ui) {\n\t\t\t\tui.item.css('background-color', '#f6f6f6');\n\t\t\t},\n\t\t\tstop: function (event, ui) {\n\t\t\t\tui.item.removeAttr('style');\n\t\t\t},\n\t\t\tchange: function () {\n\t\t\t\tobj.setting_changed();\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n\t * [Move the payment gateway up or down]\n\t * @return {[type]} [description]\n\t */\n\tobj.move_gateway = function (e) {\n\t\tlet $this = $(e.currentTarget);\n\t\tlet $row = $this.closest('tr');\n\n\t\tlet moveDown = $this.is('.wc-move-down');\n\n\t\tif (moveDown) {\n\t\t\tlet $next = $row.next('tr');\n\t\t\tif ($next && $next.length) {\n\t\t\t\t$next.after($row);\n\t\t\t}\n\t\t} else {\n\t\t\tlet $prev = $row.prev('tr');\n\t\t\tif ($prev && $prev.length) {\n\t\t\t\t$prev.before($row);\n\t\t\t}\n\t\t}\n\t\tobj.setting_changed();\n\t};\n\n\t/**\n\t * Marks the product as needing an update.\n\t *\n\t * @since 1.0.0\n\t *\n\t * @return {void}\n\t */\n\tobj.setting_changed = function () {\n\t\t$(obj.selectors.updateProductField).val('true');\n\t};\n\n\t/**\n\t * Enables a gateway.\n\t *\n\t * @since 1.0.0\n\t *\n\t * @param  {Event} e\n\t *\n\t * @return {void}\n\t */\n\tobj.enable_gateway = function (e) {\n\t\te.preventDefault();\n\t\tlet $el = $(e.currentTarget);\n\t\tlet $row = $el.closest('tr');\n\t\tlet $toggle = $el.find('.woocommerce-input-toggle');\n\n\t\t$toggle.addClass(obj.params.loadingClass);\n\t\t$.ajax({\n\t\t\turl: sswps_product_params.routes.enable_gateway,\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\t_wpnonce: sswps_product_params._wpnonce,\n\t\t\t\tproduct_id: $('#post_ID').val(),\n\t\t\t\tgateway_id: $row.data('gateway_id')\n\t\t\t}\n\t\t}).done(function (response) {\n\t\t\t$toggle.removeClass(obj.params.loadingClass);\n\t\t\tif (response.enabled) {\n\t\t\t\t$toggle.addClass(obj.params.enabledClass).removeClass(obj.params.disabledClass);\n\t\t\t} else {\n\t\t\t\t$toggle.removeClass(obj.params.enabledClass).addClass(obj.params.disabledClass);\n\t\t\t}\n\t\t}).fail(function (xhr, errorStatus, errorThrown) {\n\t\t\t$toggle.removeClass(obj.params.loadingClass);\n\t\t});\n\t};\n\n\t/**\n\t * Saves the metabox data.\n\t *\n\t * @since 1.0.0\n\t *\n\t * @param  {Event} e\n\t *\n\t * @return {void}\n\t */\n\tobj.save = function (e) {\n\t\te.preventDefault();\n\t\tlet $button = $(e.currentTarget);\n\t\tlet gateways = [];\n\t\tlet charge_types = [];\n\t\t$('[name^=\"stripe_gateway_order\"]').each(function (idx, el) {\n\t\t\tgateways.push($(el).val());\n\t\t});\n\t\t$('[name^=\"stripe_capture_type\"]').each(function (idx, el) {\n\t\t\tcharge_types.push({\n\t\t\t\tgateway: $(el).closest('tr').data('gateway_id'),\n\t\t\t\tvalue: $(el).val()\n\t\t\t});\n\t\t})\n\t\t$button.toggleClass('disabled').prop('disabled', true);\n\t\t$button.next('.spinner').toggleClass('is-active');\n\t\t$.ajax({\n\t\t\turl: sswps_product_params.routes.save,\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\t_wpnonce: sswps_product_params._wpnonce,\n\t\t\t\tgateways: gateways,\n\t\t\t\tcharge_types: charge_types,\n\t\t\t\tproduct_id: $('#post_ID').val(),\n\t\t\t\tposition: $('#_stripe_button_position').val()\n\t\t\t}\n\t\t}).done(function (response) {\n\t\t\t$button.toggleClass('disabled').prop('disabled', false);\n\t\t\t$button.next('.spinner').toggleClass('is-active');\n\t\t}).fail(function (xhr, errorStatus, errorthrown) {\n\t\t\t$button.toggleClass('disabled').prop('disabled', false);\n\t\t\t$button.next('.spinner').toggleClass('is-active');\n\t\t})\n\t};\n\n\t/**\n\t * Handles the bootstrapping of this JS file.\n\t *\n\t * @since 1.0.0\n\t *\n\t * @return {void}\n\t */\n\tobj.ready = function () {\n\t\tobj.initSorting();\n\t\tobj.bindEvents();\n\t};\n\n\t$(obj.ready);\n})(window, jQuery, window.sswps.product.metaboxes);"],"names":["window","sswps","product","metaboxes","$","obj","$document","document","selectors","gatewaysTable","enabledGateway","saveProductData","settingsSelect","updateProductField","params","loadingClass","enabledClass","disabledClass","bindEvents","find","on","move_gateway","enable_gateway","save","setting_changed","initSorting","sortable","items","axis","cursor","scrollSensitivity","forcePlaceholderSize","helper","opacity","placeholder","start","event","ui","item","css","stop","removeAttr","change","e","$this","currentTarget","$row","closest","is","$next","next","length","after","$prev","prev","before","val","preventDefault","$el","$toggle","addClass","ajax","url","sswps_product_params","routes","method","dataType","data","_wpnonce","product_id","gateway_id","done","response","removeClass","enabled","fail","xhr","errorStatus","errorThrown","$button","gateways","charge_types","each","idx","el","push","gateway","value","toggleClass","prop","position","errorthrown","ready","jQuery"],"sourceRoot":""}