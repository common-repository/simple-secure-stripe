{"version":3,"file":"admin-settings.js","mappings":"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","sources":["webpack://simple-secure-stripe/./src/assets/js/admin/admin-settings.js"],"sourcesContent":["jQuery(function ($) {\n\n\tfunction Settings() {\n\t\tthis.params = sswps_setting_params;\n\t\tthis.prefix = '#' + $('#sswps_prefix').val();\n\t\tthis.init();\n\t}\n\n\t/**\n\t * [init description]\n\t * @return {[type]} [description]\n\t */\n\tSettings.prototype.init = function () {\n\t\t$('[name^=\"woocommerce_sswps\"]').on('change', this.display_children.bind(this));\n\n\t\t$('select.stripe-accepted-cards').on('select2:select', this.reorder_multiselect);\n\n\t\t$('.api-register-domain').on('click', this.register_domain.bind(this));\n\n\t\t$('.sswps-create-webhook').on('click', this.manage_webhook.bind(this));\n\n\t\t$('.sswp-button--connection-test').on('click', this.do_connection_test.bind(this));\n\n\t\t$('.stripe-delete-connection').on('click', this.do_delete_connection.bind(this));\n\n\t\tif (typeof (sswps_admin_notices) != 'undefined') {\n\t\t\tthis.display_notices();\n\t\t}\n\n\t\tthis.display_children();\n\n\t\tif (window.location.search.match(/_stripe_connect_nonce/)) {\n\t\t\thistory.pushState({}, '', window.location.pathname + '?page=wc-settings&tab=checkout&section=sswps_api');\n\t\t}\n\t}\n\n\t/**\n\t * [display_children description]\n\t * @param  {[type]} e [description]\n\t * @return {[type]}   [description]\n\t */\n\tSettings.prototype.display_children = function (e) {\n\t\t$('[data-show-if]').each(function (i, el) {\n\t\t\tvar $this = $(el);\n\t\t\tvar values = $this.data('show-if');\n\t\t\tvar hidden = [];\n\t\t\t$.each(values, function (k, v) {\n\t\t\t\tvar $key = $(this.prefix + k);\n\t\t\t\tif (hidden.indexOf($this.attr('id')) == -1) {\n\t\t\t\t\tif ($key.is(':checkbox')) {\n\t\t\t\t\t\tif ($key.is(':checked') == v) {\n\t\t\t\t\t\t\t$this.closest('tr').show();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$this.closest('tr').hide();\n\t\t\t\t\t\t\thidden.push($this.attr('id'));\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ($key.val() == v) {\n\t\t\t\t\t\t\t$this.closest('tr').show();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$this.closest('tr').hide();\n\t\t\t\t\t\t\thidden.push($this.attr('id'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$this.closest('tr').hide();\n\t\t\t\t\thidden.push($this.attr('id'));\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}.bind(this));\n\n\t\t$('[data-hide-if-no-value]').each(function (i, el) {\n\t\t\tvar $this = $(el);\n\t\t\tvar values = $this.data('hide-if-no-value');\n\t\t\tvar hidden = [];\n\t\t\t$.each(values, function (k, v) {\n\t\t\t\tvar $key = $(this.prefix + k);\n\t\t\t\tif ($key.is(':checkbox')) {\n\t\t\t\t\tif (!$key.is(':checked')) {\n\t\t\t\t\t\t$this.closest('tr').hide();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (typeof $key.val() == 'undefined' || $key.val() == '') {\n\t\t\t\t\t\t$this.closest('tr').hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}.bind(this));\n\n\t}\n\n\t/**\n\t * [reorder_multiselect description]\n\t * @param  {[type]} e [description]\n\t * @return {[type]}   [description]\n\t */\n\tSettings.prototype.reorder_multiselect = function (e) {\n\t\tvar element = e.params.data.element;\n\t\tvar $element = $(element);\n\t\t$element.detach();\n\t\t$(this).append($element);\n\t\t$(this).trigger('change');\n\t}\n\n\t/**\n\t * [register_domain description]\n\t * @return {[type]} [description]\n\t */\n\tSettings.prototype.register_domain = function (e) {\n\t\te.preventDefault();\n\t\tthis.block();\n\t\t$.ajax({\n\t\t\turl: this.params.routes.apple_domain,\n\t\t\tdataType: 'json',\n\t\t\tmethod: 'POST',\n\t\t\tdata: {_wpnonce: this.params.rest_nonce, hostname: window.location.hostname}\n\t\t}).done(function (response) {\n\t\t\tthis.unblock();\n\t\t\tif (response.code) {\n\t\t\t\twindow.alert(response.message);\n\t\t\t} else {\n\t\t\t\twindow.alert(response.message);\n\t\t\t}\n\t\t}.bind(this)).fail(function (xhr, textStatus, errorThrown) {\n\t\t\tthis.unblock();\n\t\t\twindow.alert(errorThrown);\n\t\t}.bind(this))\n\t}\n\n\tSettings.prototype.manage_webhook = function (e) {\n\t\te.preventDefault();\n\t\tif ($(e.currentTarget).is('.sswps-delete-webhook')) {\n\t\t\tthis.delete_webhook();\n\t\t} else {\n\t\t\tthis.create_webhook();\n\t\t}\n\t}\n\n\tSettings.prototype.create_webhook = function () {\n\t\tthis.block();\n\t\tvar env = $('#woocommerce_sswps_api_mode').val();\n\t\t$.ajax({\n\t\t\turl: this.params.routes.create_webhook,\n\t\t\tdataType: 'json',\n\t\t\tmethod: 'POST',\n\t\t\tdata: {_wpnonce: this.params.rest_nonce, environment: env}\n\t\t}).done(function (response) {\n\t\t\tthis.unblock();\n\t\t\tif (response.code) {\n\t\t\t\twindow.alert(response.message);\n\t\t\t} else {\n\t\t\t\t$('#woocommerce_sswps_api_webhook_secret').val(response.secret);\n\t\t\t\twindow.alert(response.message);\n\t\t\t\twindow.location.reload();\n\t\t\t}\n\t\t}.bind(this)).fail(function (xhr, textStatus, errorThrown) {\n\t\t\tthis.unblock();\n\t\t\twindow.alert(errorThrown);\n\t\t}.bind(this))\n\t}\n\n\tSettings.prototype.delete_webhook = function () {\n\t\tthis.block();\n\t\tvar mode = $('#woocommerce_sswps_api_mode').val();\n\t\t$.ajax({\n\t\t\turl: this.params.routes.delete_webhook,\n\t\t\tdataType: 'json',\n\t\t\tmethod: 'POST',\n\t\t\tdata: {_wpnonce: this.params.rest_nonce, mode: mode}\n\t\t}).done(function (response) {\n\t\t\tthis.unblock();\n\t\t\tif (response.code) {\n\t\t\t\twindow.alert(response.message);\n\t\t\t} else {\n\t\t\t\t$('#woocommerce_sswps_api_webhook_secret').val('');\n\t\t\t\twindow.location.reload();\n\t\t\t}\n\t\t}.bind(this)).fail(function (xhr, textStatus, errorThrown) {\n\t\t\tthis.unblock();\n\t\t\twindow.alert(errorThrown);\n\t\t}.bind(this))\n\t}\n\n\tSettings.prototype.do_connection_test = function (e) {\n\t\te.preventDefault();\n\t\tthis.block();\n\t\tvar mode = $('#woocommerce_sswps_api_mode').val();\n\t\t$.ajax({\n\t\t\turl: this.params.routes.connection_test,\n\t\t\tdataType: 'json',\n\t\t\tmethod: 'POST',\n\t\t\tdata: (function () {\n\t\t\t\tvar data = {\n\t\t\t\t\t_wpnonce: this.params.rest_nonce,\n\t\t\t\t\tmode: mode\n\t\t\t\t};\n\t\t\t\tif (mode === 'test') {\n\t\t\t\t\tdata.secret_key = $('#woocommerce_sswps_api_secret_key_test').val();\n\t\t\t\t\tdata.publishable_key = $('#woocommerce_sswps_api_publishable_key_test').val();\n\t\t\t\t}\n\t\t\t\treturn data;\n\t\t\t}.bind(this)())\n\t\t}).done(function (response) {\n\t\t\tthis.unblock();\n\t\t\tif (response.code) {\n\t\t\t\twindow.alert(response.message);\n\t\t\t} else {\n\t\t\t\twindow.alert(response.message);\n\t\t\t}\n\t\t}.bind(this)).fail(function (xhr, textStatus, errorThrown) {\n\t\t\tthis.unblock();\n\t\t\twindow.alert(errorThrown);\n\t\t}.bind(this))\n\t}\n\n\tSettings.prototype.display_notices = function () {\n\t\t$.each(sswps_admin_notices, function (idx, notice) {\n\t\t\t$('.woo-nav-tab-wrapper').after(notice);\n\t\t}.bind(this))\n\t}\n\n\t/**\n\t * [block description]\n\t * @param  {[type]} $el [description]\n\t * @return {[type]}     [description]\n\t */\n\tSettings.prototype.block = function () {\n\t\t$('.sswps-settings-container').block({\n\t\t\tmessage: null,\n\t\t\toverlayCSS: {\n\t\t\t\tbackground: '#fff',\n\t\t\t\topacity: 0.6\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * [unblock description]\n\t * @param  {[type]} $el [description]\n\t * @return {[type]}     [description]\n\t */\n\tSettings.prototype.unblock = function () {\n\t\t$('.sswps-settings-container').unblock();\n\t}\n\n\tSettings.prototype.do_delete_connection = function (e) {\n\t\te.preventDefault();\n\t\tif (confirm(this.params.messages.delete_connection)) {\n\t\t\tthis.block();\n\t\t\t$.ajax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\turl: this.params.routes.delete_connection,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {_wpnonce: this.params.rest_nonce}\n\t\t\t}).done(function (response) {\n\t\t\t\tthis.unblock();\n\t\t\t\tif (!response.code) {\n\t\t\t\t\twindow.location.reload();\n\t\t\t\t} else {\n\t\t\t\t\twindow.alert(response.message);\n\t\t\t\t}\n\t\t\t}.bind(this)).fail(function () {\n\t\t\t\tthis.unblock();\n\t\t\t}.bind(this));\n\t\t}\n\t}\n\n\tnew Settings();\n\n});"],"names":["jQuery","$","Settings","this","params","sswps_setting_params","prefix","val","init","prototype","on","display_children","bind","reorder_multiselect","register_domain","manage_webhook","do_connection_test","do_delete_connection","sswps_admin_notices","display_notices","window","location","search","match","history","pushState","pathname","e","each","i","el","$this","values","data","hidden","k","v","$key","indexOf","attr","is","closest","show","hide","push","element","$element","detach","append","trigger","preventDefault","block","ajax","url","routes","apple_domain","dataType","method","_wpnonce","rest_nonce","hostname","done","response","unblock","code","alert","message","fail","xhr","textStatus","errorThrown","currentTarget","delete_webhook","create_webhook","env","environment","secret","reload","mode","connection_test","secret_key","publishable_key","idx","notice","after","overlayCSS","background","opacity","confirm","messages","delete_connection"],"sourceRoot":""}