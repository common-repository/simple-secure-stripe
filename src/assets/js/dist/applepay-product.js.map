{"version":3,"file":"applepay-product.js","mappings":"CAAC,SAAUA,EAAGC,GAEV,SAASC,IACLD,EAAME,YAAYC,KAAKC,KAAMC,+BAC7BD,KAAKE,QAAUF,KAAKG,cACxB,CAMAN,EAASO,UAAYT,EAAEU,OAAO,CAAC,EAAGT,EAAME,YAAYM,UAAWR,EAAMU,eAAeF,UAAWR,EAAMC,SAASO,WAE9GP,EAASO,UAAUG,WAAa,WACvBZ,EAAE,kCAAoCK,KAAKQ,WAAWC,QAI3DT,KAAKQ,UAAY,kCAAoCR,KAAKQ,UAC1DZ,EAAMU,eAAeP,KAAKC,MAC1BJ,EAAMC,SAASO,UAAUG,WAAWR,KAAKC,OALrCU,WAAWV,KAAKO,WAAWI,KAAKX,MAAO,IAM/C,EAKAH,EAASO,UAAUQ,eAAiB,WAChChB,EAAMC,SAASO,UAAUQ,eAAeb,KAAKC,MAAMa,KAAK,WACpDlB,EAAEmB,SAASC,MAAMC,GAAG,SAAU,oBAAqBhB,KAAKiB,qBAAqBN,KAAKX,OAClFL,EAAEK,KAAKQ,WAAWU,SAASA,SAASC,SAAS,UACxCnB,KAAKoB,sBAGFpB,KAAKqB,4BACLrB,KAAKsB,iBAAiBtB,KAAKuB,mBAAmBC,UAAUC,cAExDzB,KAAK0B,yBALT1B,KAAKsB,kBAQb,EAAEX,KAAKX,MACX,EAEAH,EAASO,UAAUkB,iBAAmB,WAClC,OAAO1B,EAAMU,eAAeF,UAAUkB,iBAAiBK,MAAM3B,KAAM4B,WAAWf,KAAK,SAAUgB,GACzF7B,KAAK8B,6BAA6BD,EACtC,EAAElB,KAAKX,MACX,EAMAH,EAASO,UAAU2B,MAAQ,SAAUC,GACL,IAAxBhC,KAAKG,gBACL6B,EAAEC,iBACFjC,KAAKkC,aAAalC,KAAKmC,OAAOC,SAASC,kBAElCrC,KAAKsC,kBACNtC,KAAKuC,cAET3C,EAAMC,SAASO,UAAU2B,MAAMJ,MAAM3B,KAAM4B,WAEnD,EAKA/B,EAASO,UAAUoC,cAAgB,WAC/B,IAAIhC,EAAYM,SAAS2B,iBAAiB,6BACtCjC,GAAaA,EAAUC,OAAS,GAChCd,EAAE+C,KAAKlC,EAAW,SAAUmC,EAAKC,GAC7BjD,EAAEiD,GAAMC,QACRlD,EAAEiD,GAAME,OAAO9C,KAAK+C,QAAQC,OAAM,GACtC,EAAErC,KAAKX,OACPA,KAAK+C,QAAUpD,EAAE,6BAA6BsD,KAAK,WAEnDtD,EAAE,6BAA6BmD,OAAO9C,KAAK+C,QAEnD,EAEAlD,EAASO,UAAUa,qBAAuB,WACtCjB,KAAK0B,yBACL1B,KAAKE,QAAUF,KAAKG,eACfH,KAAKoB,wBAAyBpB,KAAKqB,6BACpCrB,KAAKsB,mBAAmBT,KAAK,WACrBb,KAAKoB,uBACLpB,KAAKkD,uBACLtD,EAAMC,SAASO,UAAUQ,eAAee,MAAM3B,KAAM4B,WAAWf,KAAK,WAChEb,KAAKmD,uBACT,EAAExC,KAAKX,QAEPA,KAAKmD,uBAEb,EAAExC,KAAKX,MAEf,EAEAH,EAASO,UAAUgD,gBAAkB,SAAUpB,GAC3CpC,EAAMU,eAAeF,UAAUgD,gBAAgBzB,MAAM3B,KAAM4B,WACvD5B,KAAKqD,SACLrD,KAAKiB,sBAEb,EAEA,IAAIpB,CAEP,CA1GA,CA0GCyD,OAAQ1D","sources":["webpack://simple-secure-stripe/./src/assets/js/frontend/applepay-product.js"],"sourcesContent":["(function ($, sswps) {\n\n    function ApplePay() {\n        sswps.BaseGateway.call(this, sswps_applepay_product_params);\n        this.old_qty = this.get_quantity();\n    }\n\n    /**\n     * [prototype description]\n     * @type {[type]}\n     */\n    ApplePay.prototype = $.extend({}, sswps.BaseGateway.prototype, sswps.ProductGateway.prototype, sswps.ApplePay.prototype);\n\n    ApplePay.prototype.initialize = function () {\n        if (!$('.sswps_product_payment_methods ' + this.container).length) {\n            setTimeout(this.initialize.bind(this), 1000);\n            return;\n        }\n        this.container = '.sswps_product_payment_methods ' + this.container;\n        sswps.ProductGateway.call(this);\n        sswps.ApplePay.prototype.initialize.call(this);\n    }\n\n    /**\n     * @return {[type]}\n     */\n    ApplePay.prototype.canMakePayment = function () {\n        sswps.ApplePay.prototype.canMakePayment.call(this).then(function () {\n            $(document.body).on('change', '[name=\"quantity\"]', this.maybe_calculate_cart.bind(this));\n            $(this.container).parent().parent().addClass('active');\n            if (!this.is_variable_product()) {\n                this.cart_calculation();\n            } else {\n                if (this.variable_product_selected()) {\n                    this.cart_calculation(this.get_product_data().variation.variation_id);\n                } else {\n                    this.disable_payment_button();\n                }\n            }\n        }.bind(this))\n    }\n\n    ApplePay.prototype.cart_calculation = function () {\n        return sswps.ProductGateway.prototype.cart_calculation.apply(this, arguments).then(function (data) {\n            this.update_from_cart_calculation(data);\n        }.bind(this))\n    }\n\n    /**\n     * @param  {[type]}\n     * @return {[type]}\n     */\n    ApplePay.prototype.start = function (e) {\n        if (this.get_quantity() === 0) {\n            e.preventDefault();\n            this.submit_error(this.params.messages.invalid_amount);\n        } else {\n            if (!this.needs_shipping()) {\n                this.add_to_cart();\n            }\n            sswps.ApplePay.prototype.start.apply(this, arguments);\n        }\n    }\n\n    /**\n     * @return {[type]}\n     */\n    ApplePay.prototype.append_button = function () {\n        var container = document.querySelectorAll('.sswps-applepay-container');\n        if (container && container.length > 1) {\n            $.each(container, function (idx, node) {\n                $(node).empty();\n                $(node).append(this.$button.clone(true));\n            }.bind(this));\n            this.$button = $('.sswps-applepay-container').find('button');\n        } else {\n            $('#sswps-applepay-container').append(this.$button);\n        }\n    }\n\n    ApplePay.prototype.maybe_calculate_cart = function () {\n        this.disable_payment_button();\n        this.old_qty = this.get_quantity();\n        if (!this.is_variable_product() || this.variable_product_selected()) {\n            this.cart_calculation().then(function () {\n                if (this.is_variable_product()) {\n                    this.createPaymentRequest();\n                    sswps.ApplePay.prototype.canMakePayment.apply(this, arguments).then(function () {\n                        this.enable_payment_button();\n                    }.bind(this));\n                } else {\n                    this.enable_payment_button();\n                }\n            }.bind(this));\n        }\n    }\n\n    ApplePay.prototype.found_variation = function (e) {\n        sswps.ProductGateway.prototype.found_variation.apply(this, arguments);\n        if (this.can_pay) {\n            this.maybe_calculate_cart();\n        }\n    }\n\n    new ApplePay();\n\n}(jQuery, sswps))"],"names":["$","sswps","ApplePay","BaseGateway","call","this","sswps_applepay_product_params","old_qty","get_quantity","prototype","extend","ProductGateway","initialize","container","length","setTimeout","bind","canMakePayment","then","document","body","on","maybe_calculate_cart","parent","addClass","is_variable_product","variable_product_selected","cart_calculation","get_product_data","variation","variation_id","disable_payment_button","apply","arguments","data","update_from_cart_calculation","start","e","preventDefault","submit_error","params","messages","invalid_amount","needs_shipping","add_to_cart","append_button","querySelectorAll","each","idx","node","empty","append","$button","clone","find","createPaymentRequest","enable_payment_button","found_variation","can_pay","jQuery"],"sourceRoot":""}