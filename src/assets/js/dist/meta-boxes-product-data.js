window.sswps=window.sswps||{},window.sswps.product=window.sswps.product||{},window.sswps.product.metaboxes=window.sswps.product.metaboxes||{},function(e,a,s){"use strict";a(e);var t=a(document);s.selectors={gatewaysTable:"table.wc_gateways",enabledGateway:"table.wc_gateways .sswps-product-gateway-enabled",saveProductData:".sswps-save-product-data",settingsSelect:"#stripe_product_data select",updateProductField:"#sswps_update_product"},s.params={loadingClass:"woocommerce-input-toggle--loading",enabledClass:"woocommerce-input-toggle--enabled",disabledClass:"woocommerce-input-toggle--disabled"},s.bindEvents=function(){a(s.selectors.gatewaysTable).find(".wc-move-down, .wc-move-up").on("click",s.move_gateway),t.on("click",s.selectors.enabledGateway,s.enable_gateway),t.on("click",s.selectors.saveProductData,s.save),t.on("change",s.selectors.settingsSelect,s.setting_changed)},s.initSorting=function(){a(s.selectors.gatewaysTable).sortable({items:"tr",axis:"y",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(e,a){a.item.css("background-color","#f6f6f6")},stop:function(e,a){a.item.removeAttr("style")},change:function(){s.setting_changed()}})},s.move_gateway=function(e){var t=a(e.currentTarget),o=t.closest("tr");if(t.is(".wc-move-down")){var n=o.next("tr");n&&n.length&&n.after(o)}else{var l=o.prev("tr");l&&l.length&&l.before(o)}s.setting_changed()},s.setting_changed=function(){a(s.selectors.updateProductField).val("true")},s.enable_gateway=function(e){e.preventDefault();var t=a(e.currentTarget),o=t.closest("tr"),n=t.find(".woocommerce-input-toggle");n.addClass(s.params.loadingClass),a.ajax({url:sswps_product_params.routes.enable_gateway,method:"POST",dataType:"json",data:{_wpnonce:sswps_product_params._wpnonce,product_id:a("#post_ID").val(),gateway_id:o.data("gateway_id")}}).done((function(e){n.removeClass(s.params.loadingClass),e.enabled?n.addClass(s.params.enabledClass).removeClass(s.params.disabledClass):n.removeClass(s.params.enabledClass).addClass(s.params.disabledClass)})).fail((function(e,a,t){n.removeClass(s.params.loadingClass)}))},s.save=function(e){e.preventDefault();var s=a(e.currentTarget),t=[],o=[];a('[name^="stripe_gateway_order"]').each((function(e,s){t.push(a(s).val())})),a('[name^="stripe_capture_type"]').each((function(e,s){o.push({gateway:a(s).closest("tr").data("gateway_id"),value:a(s).val()})})),s.toggleClass("disabled").prop("disabled",!0),s.next(".spinner").toggleClass("is-active"),a.ajax({url:sswps_product_params.routes.save,method:"POST",dataType:"json",data:{_wpnonce:sswps_product_params._wpnonce,gateways:t,charge_types:o,product_id:a("#post_ID").val(),position:a("#_stripe_button_position").val()}}).done((function(e){s.toggleClass("disabled").prop("disabled",!1),s.next(".spinner").toggleClass("is-active")})).fail((function(e,a,t){s.toggleClass("disabled").prop("disabled",!1),s.next(".spinner").toggleClass("is-active")}))},s.ready=function(){s.initSorting(),s.bindEvents()},a(s.ready)}(window,jQuery,window.sswps.product.metaboxes);
//# sourceMappingURL=meta-boxes-product-data.js.map